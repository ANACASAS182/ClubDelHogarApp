<ion-content class="page" fullscreen>
  <div class="center-wrapper">

    <div class="card" [formGroup]="formularioRegistro">
      <img src="assets/logo.png" alt="Logo" class="logo" />
      <h1 class="form-title">¡TE DAMOS LA BIENVENIDA!</h1>
      <h3 class="form-title">Crea tu cuenta como embajador </h3>

      <div class="codigo-cupon" *ngIf="codigo != ''">
        <p class="invitador-texto">Fuiste invitado a unirte por <br/><strong>{{ nombreInvitador }}</strong></p>
      </div>

      <ion-grid>
        <ion-row>

          <ion-col size="12" size-md="12">
            <ion-input class="input" [class.invalid]="getControl('email')?.invalid && getControl('email')?.touched"
              formControlName="email" label-placement="floating" label="Correo electrónico" type="text"
              (ionBlur)="getControl('email')?.markAsTouched()"  [readonly]="codigo != ''">
            </ion-input>
            <ion-text color="danger" *ngIf="getControl('email')?.invalid && getControl('email')?.touched">
              Es obligatorio ingresar tu correo electrónico
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input" [class.invalid]="getControl('nombre')?.invalid && getControl('nombre')?.touched"
              formControlName="nombre" label-placement="floating" label="Nombre(s)" type="text"
              
              (ionBlur)="getControl('nombre')?.markAsTouched()"></ion-input>
            <ion-text color="danger" *ngIf="getControl('nombre')?.invalid && getControl('nombre')?.touched">
              Es obligatorio ingresar tu nombre
            </ion-text>



          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input"
              [class.invalid]="getControl('apellido')?.invalid && getControl('apellido')?.touched"
              formControlName="apellido" label-placement="floating" label="Apellido(s)" type="text"
              (ionBlur)="getControl('apellido')?.markAsTouched()"></ion-input>
            <ion-text color="danger" *ngIf="getControl('apellido')?.invalid && getControl('apellido')?.touched">
              Es obligatorio ingresar tus apellidos
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-select [interfaceOptions]="{ header: 'Pais'}" class="input" okText="Ok" cancelText="Cancelar" [class.invalid]="getControl('pais')?.invalid && getControl('pais')?.touched"
              formControlName="pais" placeholder="Pais" (ionChange)="onPaisChange($event)"
              (ionBlur)="getControl('pais')?.markAsTouched()">
              <ion-select-option *ngFor="let pais of paises" [value]="pais.id">
                {{ pais.descripcion }}
              </ion-select-option>
            </ion-select>
            <ion-text color="danger" *ngIf="getControl('pais')?.invalid && getControl('pais')?.touched">
              Es obligatorio ingresar el país al que perteneces
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6" *ngIf="isNacional">
            <ion-select [interfaceOptions]="{ header: 'Estado'}" okText="Ok" cancelText="Cancelar" class="input" [class.invalid]="getControl('estado')?.invalid && getControl('estado')?.touched"
              formControlName="estado" placeholder="Estado" class="input"
              (ionBlur)="getControl('estado')?.markAsTouched()">
              <ion-select-option *ngFor="let estad of estados" [value]="estad.id">
                {{ estad.nombre }}
              </ion-select-option>
            </ion-select>
            <ion-text color="danger" *ngIf="getControl('estado')?.invalid && getControl('estado')?.touched">
              Es obligatorio ingresar el estado al que perteneces
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6" *ngIf="!isNacional">
            <ion-input class="input"
              [class.invalid]="getControl('estadoTexto')?.invalid && getControl('estadoTexto')?.touched"
              formControlName="estadoTexto" placeholder="Estado" type="text"
              (ionBlur)="getControl('estadoTexto')?.markAsTouched()">
            </ion-input>
            <ion-text color="danger" *ngIf="getControl('estadoTexto')?.invalid && getControl('estadoTexto')?.touched">
              Campo requerido
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input" [class.invalid]="getControl('ciudad')?.invalid && getControl('ciudad')?.touched"
              formControlName="ciudad" label-placement="floating" label="Ciudad" type="text"
              (ionBlur)="getControl('ciudad')?.markAsTouched()">
            </ion-input>
            <ion-text color="danger" *ngIf="getControl('ciudad')?.invalid && getControl('ciudad')?.touched">
              Es obligatorio ingresar el nombre de tu ciudad
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-select class="input" [interfaceOptions]="{ header: '¿Como suspiste del programa?'}" okText="Ok" cancelText="Cancelar"
              [class.invalid]="getControl('fuenteOrigen')?.invalid && getControl('fuenteOrigen')?.touched"
              formControlName="fuenteOrigen" placeholder="¿Como suspiste del programa?" class="input"
              (ionBlur)="getControl('fuenteOrigen')?.markAsTouched()">
              <ion-select-option *ngFor="let fuenteO of fuentesOrigen" [value]="fuenteO.id">
                {{ fuenteO.nombre }}
              </ion-select-option>
            </ion-select>
            <ion-text color="danger" *ngIf="getControl('fuenteOrigen')?.invalid && getControl('fuenteOrigen')?.touched">
              Es obligatorio seleccionar la forma en la que supiste de Embassy 
            </ion-text>
          </ion-col>

         

          <ion-col size="12" size-md="6">
            <ion-input class="input"
              [class.invalid]="getControl('telefono')?.invalid && getControl('telefono')?.touched"
              formControlName="telefono" label-placement="floating" label="Número de teléfono" type="text"
              (ionBlur)="getControl('telefono')?.markAsTouched()">
            </ion-input>
            <ion-text color="danger" *ngIf="getControl('telefono')?.invalid && getControl('telefono')?.touched">
              Es obligatorio ingresar tu número de teléfono
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input"
              [class.invalid]="getControl('confirmTelefono')?.invalid && getControl('confirmTelefono')?.touched"
              formControlName="confirmTelefono" label-placement="floating" label="Confirma tú número de teléfono" type="text"
              (ionBlur)="getControl('confirmTelefono')?.markAsTouched()">
            </ion-input>
            <ion-text color="danger"
              *ngIf="getControl('confirmTelefono')?.invalid && getControl('confirmTelefono')?.touched">
              Es obligatorio confirmar tu número de teléfono
            </ion-text>

            <ion-text color="danger"
              *ngIf="getControl('confirmTelefono')?.errors?.['mustMatch'] && getControl('confirmTelefono')?.touched">
              <br/>Los números de teléfono ingresados no son iguales
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input"
              [class.invalid]="getControl('password')?.invalid && getControl('password')?.touched"
              formControlName="password" placeholder="Crear tu contraseña" type="password"
              (ionBlur)="getControl('password')?.markAsTouched()" (ionInput)="checkStrength()">
              <ion-input-password-toggle slot="end"></ion-input-password-toggle>
            </ion-input>
            <ion-progress-bar [value]="passwordStrengthValue" [color]="passwordStrengthColor"></ion-progress-bar>
            <ion-text color="{{ passwordStrengthColor }}">
              {{ passwordStrengthText }}
            </ion-text>
            <ion-text color="danger" *ngIf="getControl('password')?.hasError('required') && getControl('password')?.touched">
              Es obligatorio ingresar tu contraseña
            </ion-text>
            <ion-text color="danger" *ngIf="getControl('password')?.hasError('minlength') && getControl('password')?.touched">
              La contraseña debe tener al menos 6 caracteres.
            </ion-text>
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-input class="input"
              [class.invalid]="getControl('confirmPassword')?.invalid && getControl('confirmPassword')?.touched"
              formControlName="confirmPassword" placeholder="Confirmar contraseña" type="password"
              (ionBlur)="getControl('confirmPassword')?.markAsTouched()">
              <ion-input-password-toggle slot="end"></ion-input-password-toggle>
            </ion-input>
            <ion-text color="danger"
              *ngIf="getControl('confirmPassword')?.invalid && getControl('confirmPassword')?.touched">
              Es obligatorio confirmar tu contraseña
            </ion-text>
            <ion-text color="danger"
              *ngIf="getControl('confirmPassword')?.errors?.['mustMatch'] && getControl('confirmPassword')?.touched">
              <br/>La contraseña no coincide
            </ion-text>
          </ion-col>

        </ion-row>
      </ion-grid>

      


      <ion-button class="customButton" shape="round" expand="block" type="submit" [disabled]="formEnviado" (click)="enviarFormulario()">
        CREAR CUENTA
      </ion-button>

    </div>


  </div>
</ion-content>